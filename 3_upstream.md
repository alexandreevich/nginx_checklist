# üí° –ß—Ç–æ —Ç–∞–∫–æ–µ upstream?
upstream ‚Äî —ç—Ç–æ –±–ª–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ NGINX, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ backend-—Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ "–ø—É–ª" –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –º–µ–∂–¥—É –Ω–∏–º–∏ –Ω–∞–≥—Ä—É–∑–∫—É.

–ü—Ä–∏–º–µ—Ä –ª–µ–∂–∏—Ç —Ç—É—Ç [upstream.conf](https://github.com/alexandreevich/nginx_checklist/blob/main/upstream/upstream.conf)

## –ì–¥–µ:
- my_app_servers ‚Äî —ç—Ç–æ –∏–º—è –ø—É–ª–∞.
- –°–ø–∏—Å–æ–∫ server –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞ ‚Äî —ç—Ç–æ IP-–∞–¥—Ä–µ—Å–∞ –∏–ª–∏ —Ö–æ—Å—Ç–Ω–µ–π–º—ã backend-—Å–µ—Ä–≤–∏—Å–æ–≤.
- –ö–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ NGINX, —Ç–æ—Ç —Å–∞–º —Ä–µ—à–∞–µ—Ç –Ω–∞ –∫–∞–∫–æ–π backend –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å.

## üéØ –¢–∏–ø—ã –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –≤ NGINX:

| –ú–µ—Ç–æ–¥	| –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç |
|--------|------------------------
| round-robin (–ø–æ –∫—Ä—É–≥—É)	|–°—Ç–∞–Ω–¥–∞—Ä—Ç. –ó–∞–ø—Ä–æ—Å—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞.|
| least_conn	| –û—Ç–¥–∞—ë—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º–∏ –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏.|
|ip_hash	| –ù–∞–∑–Ω–∞—á–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ IP –∫–ª–∏–µ–Ω—Ç–∞.|
|random	| –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑ —Å–ø–∏—Å–∫–∞.|

## ‚ö†Ô∏è –ó–∞—á–µ–º ?
- –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤;
- –¥–ª—è High Availability;
- –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã—Ö —Å–∏—Å—Ç–µ–º;
- –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ production-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–ø–∏—è–º–∏ backend.

## üí° –í 99% —Å–ª—É—á–∞–µ–≤ DevOps –∏—Å–ø–æ–ª—å–∑—É–µ—Ç upstream –ø—Ä–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:
- –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞;
- –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤;
- —Ä–∞–∑—Ä—É–ª–∏–≤–∞–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏.
